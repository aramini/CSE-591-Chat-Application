<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Archive</title>
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
</head>

<body>

<div class="modal-body row">
  <div class="col-md-8">
    <div id="archiveChat" class="well" style="height:500px; overflow-y:auto;"></div>
  </div>
  <div class="col-md-4">
    <div id="archiveLinks" class="well" style="height:500px; overflow-y:auto;"></div>
  </div>
</div>

    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
    /*var socket = io.connect('http://localhost:3000');
        socket.on('connect', function() {
         socket.emit('updatearchivechat');
        });*/

    /* socket.on('updatearchivechat1', function(user,text){
              if (user.match(/Expert/)) {
            $('#archiveChat').append('<div class="panel" style="color:blue;"> <b>' + user + '</b> : ' + text + '<div class="badge">2</div></div>');
        } else {
            $('#archiveChat').append('<div class="panel"><b>' + user + '</b> : ' + text + '<span class="glyphicon glyphicon-ok pull-right" aria-hidden="true"></span></div>');
        }
    });
*/

    $(document).ready(function() {
        $.ajax({
            type: "GET",
            url: "api/updatearchivechat",
            success: function(msg) {
                msg.forEach(function(mes) {
                  
                  var mes= mes.replace('_', '"');
                  var mes = mes.replace(':','":');
                  var mes = mes.replace(',',',"');
                  var mes = mes.replace(/'/g, '"');
                  console.log(mes);
                  var obj = JSON.parse(mes);
                  console.log(obj.user);
                    $('#archiveChat').append(mes);
                });
            }
        });
        $.ajax({
            type: "GET",
            url: "api/updatearchivelinks",
            success: function(msg) {
                $.each(JSON.parse(msg), function(err, obj) {
                    $('#archiveLinks').append('<a class="panel" href='+ obj.url +'>' + obj.title + '</a></br>');
                });

            }
        });

    });
    </script>
</body>

</html>
